### Задание 1: [ButtonBounceProcessing](./ButtonBounceProcessing)

При нажатии на кнопку следующие 50мс нажатия не считываются для избежания дребезга

### Задание 2: [ButtonMatrix](./ButtonMatrix)

Матрица переключателей, имитмрующих кнопки. Выводит все включенные переключатели. После выключения выводит время, когда кнопка была нажата, и суммарное время нажатия.

### Задание 3: [RangeCalibration](./RangeCalibration)

Ультракрасный датчик калибрует свои показания по звуковому датчику.
Программа на python по команде "c" создаёт модель, собирая данные в рамках диапазона (для примера взято 20-40),
строит график. По команде "р" предсказывает расстояние для ультракрасного датчика по созданной модели.
[Видео-демонстрация](https://disk.yandex.ru/i/FqBm-0urL0miyg)

### Задание 6: [H-Bridge](./H-Bridge)
Двигатель крутится в разные стороны и с разной скоростью в зависимости от команды.

### Задание 7-8: [Car Calibration](./Car_calibration)
Нажание на X запускает режим калибровки, нажатие на S (квадрат) запускает режим управления клавишами, треугольник 
запускает режим езды вдольь стенки (машину состояний), круг калибрует скорость колес.
В режиме калибровки ('X') используйте команды: 'F' — Вперед, 'B' — Назад, 'L' — Влево, 'R' — Вправо.
Каждое нажатие меняет закрепленное за клавишей направление. После нажатия робот кратковременно движется
в выбранном направлении.

В режиме «Колеса» («C»): «L» — выбор левого колеса «R» — выбор правого колеса «F» —
увеличение скорости вращения выбранного колеса «B» — уменьшение скорости вращения выбранного колеса.
Скорость изменяется с шагом 10 (от 100 до 260). После изменения скорости робот ненадолго движется вперед
для тестирования.

[Видео-демонстрация](https://drive.google.com/file/d/138RgA3yOCfYzPGSnz6BsTojOpLlt7Vag/view?usp=drive_link)

# ИТОГОВЫЙ ПРОЕКТ: [DungeonGame](./PROJECT)

## Описание проекта

Проект представляет собой устройство с игровым полем 4 на 4 клетки, оснащённым сенсорами.
Пользователь получает задание по прохождению поля через Телеграм-бот и ставит фигурку в предположительно
правильную клетку. Устройство передаёт данные о состоянии поля на сервер.
После выполнения задания на сервере анализируется правильность расположения и устройство даёт обратную связь:
при правильном решении загорается зелёный светодиод.

## Схема собранного устройства

### Этап 1: тестирование сенсоров.

К арудино уно подключены три сенсора, при нажатии на сенсоры в консоль выводится номер
нажатого сенсора, горит встроенная лампочка. [Видео-демонстрация.](https://disk.yandex.ru/i/cNwrwfTaWedlqw)



## Взаимодействия частей системы

Устройство состоит из 16 датчиков-сенсоров, мультиплексора и платы ESP8266 с доступом к wifi. 

Сенсорные кнопки для Wemos рекомендуется подключать к 3.3V, будем использовать режим работы по умолчанию: кнопка
без фиксации (не работает как переключатель), при нажатии выдаёт HIGH. Важно, что нажатие кнопки в течении
нескольких секунд переводит ее в режим калибровки: она перестает считывать текущее нажатие. Это понадобится при 
добавлении устройству крышки поверх сенсоров.

Кнопки выдают digital сигнал, который идёт на пины C0-C15 мультиплексора. Мультиплексор хранит сигналы каждого
из пинов и выдает их при обращении. Чтобы обратиться к конкретному пину необходимо подать на S0-S3 сигналы,
складывающиеся в бинарное представление номера нужного пина. Они подключены к плате Wemos следующим образом:

Multiplexor S0 -> Wemos D1 (pin 5)
Multiplexor S1 -> Wemos D2 (pin 6)
Multiplexor S2 -> Wemos D5 (pin 14)
Multiplexor S3 -> Wemos D6 (pin 12)

Мы также соединяем пин мультиплексора EN с пином D8 (pin 15) платы ESP. Этот пин отвечает за включение и
выключение мультиплексора. Передаем на него сигнал LOW, чтобы получить доступ к мультиплексору. 

Последний пин мультиплексора, SIG, возвращает нам нужный сигнал. Поскольку кнопки выдают нам digital-сигналы,
подключим его к соответсвтующему пину: D7 (13 по внутренней распиновке). 

Через MQTT-брокер получаем id чата, с которым связано устройство. Это будет наш топик для отправки данных на брокер.

Сервер слушает данные брокера и сохраняет их в БД sqlite при каждом обновлении. Когда пользователь в телеграм-боте вводит 
любую команду, достаются его последние данные из БД и проверяются на соответствие ответу.

## Первое подключение

## Use-Case сценарии
![Регистрация пользователя](./PROJECT/photos/Кейс%20_Регистрация_.png)

### Регистрация пользователя

Для регистрации пользователь запускает телеграм-бота и вводит свое имя, а затем - идентификатор устройства.
Далее, если введенное устройство существует в системе и является включенным в данный момент, пользователь 
связывается с этим устройством и получает положительный ответ в переписке с ботом. Если же устройство не найдено 
или не включено в данный момент, то пользователю сообщается об этой ошибке.

![Процесс игры](./PROJECT/photos/Кейс%20_Процесс%20игры_.png)

### Начало игры

Чтобы начать игру, пользователь включает зарегистрированное устройство и вводит нужную команду в бот.
В случае, если одно из условий не выполнено, бот или устройство входит в режим ожидания: пользователю приходит
соответствующее сообщение или устройство мигает лампочкой. После ввода
команды и включения устройства лампочка загорается зеленым на несколько секунд и гаснет.
Сервер делает запрос к Базе данных и отправляет в бот текст задания. 

### Верное выполнение задания

Пользователь ставит фигуру на нужную клетку. Если его ход верен по условию задания, лампочка загорается зеленым и
в бот выводится сообщение с обоснованием решения и следующим заданием, после чего лампочка гаснет.

### Неверное выполнение задания

Пользователь ставит фигуру не на нужную клетку. В бот выводится сообщение о том, что игрок проиграли вопрос,
хочет ли игрок начать игру заново.

![Окончание игры](./PROJECT/photos/Кейс%20_Конец%20игры_.png)

### Окончание игры

Пользователь сообщает боту о желании закончить игру либо с выдачи задания проходит более 5 минут.
Устройство входит в режим ожидания (начинает мигать).
Бот приходит к исходному состоянию, предлагая начать игру.

### Отключение устройства

Бот сообщает о том, что не может зафиксировать устройство. После подключения устройства игра продолжается.